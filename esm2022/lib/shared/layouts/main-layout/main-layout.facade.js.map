{"version":3,"file":"main-layout.facade.js","sourceRoot":"","sources":["../../../../../../../../../packages/modules/rc-ui/src/lib/shared/layouts/main-layout/main-layout.facade.ts"],"names":[],"mappings":"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","sourcesContent":["import { BreakpointObserver } from '@angular/cdk/layout';\nimport { Injectable, inject } from '@angular/core';\nimport { BehaviorSubject, combineLatest, map, shareReplay } from 'rxjs';\n\nimport { VCLBreakpoints } from '@vcl/ng-vcl';\n\nimport {\n  RcLayoutConfig,\n  RcLayoutNavCategory,\n  RcLayoutNavCategoryId,\n  RcLayoutNavItem,\n} from './main-layout-config.model';\n\n@Injectable({ providedIn: 'root' })\nexport class RcLayoutFacade {\n  private breakpointObserver = inject(BreakpointObserver);\n\n  isHandset$ = this.breakpointObserver\n    .observe([VCLBreakpoints.xs, VCLBreakpoints.sm])\n    .pipe(\n      map((state) => state.matches),\n      shareReplay({ bufferSize: 1, refCount: true }),\n    );\n\n  private collapsedSubject = new BehaviorSubject<boolean>(false);\n  collapsed$ = this.collapsedSubject.asObservable();\n\n  private navItemsSubject = new BehaviorSubject<RcLayoutNavItem[]>([]);\n  private categoriesSubject = new BehaviorSubject<RcLayoutNavCategory[]>([]);\n\n  private navItems$ = this.navItemsSubject.asObservable();\n  categories$ = this.categoriesSubject.asObservable();\n\n  private activeCategorySubject = new BehaviorSubject<RcLayoutNavCategoryId>(\n    this.categoriesSubject.value[0]?.id ?? 'home',\n  );\n\n  activeCategory$ = this.activeCategorySubject.asObservable();\n\n  visibleNavItems$ = combineLatest([\n    this.navItems$,\n    this.activeCategory$,\n    this.categories$,\n  ]).pipe(\n    map(([items, activeCategory, categories]) => {\n      const defaultCategoryId = categories[0]?.id;\n      return items.filter((item) => {\n        const id = item.categoryId ?? defaultCategoryId;\n        return id === activeCategory;\n      });\n    }),\n  );\n\n  /** Called by the shell once it has the config */\n  initConfig(config: RcLayoutConfig): void {\n    const navItems = config.navItems ?? [];\n    const categories =\n      config.categories && config.categories.length\n        ? config.categories\n        : [{ id: 'home', label: 'Home' }];\n\n    this.navItemsSubject.next(navItems);\n    this.categoriesSubject.next(categories);\n\n    // reset active category if needed\n    const firstId = categories[0]?.id ?? 'home';\n    this.activeCategorySubject.next(firstId);\n  }\n\n  toggleSidebar() {\n    this.collapsedSubject.next(!this.collapsedSubject.value);\n  }\n\n  setNavItems(items: RcLayoutNavItem[]): void {\n    this.navItemsSubject.next(items);\n  }\n\n  setActiveCategory(id: RcLayoutNavCategoryId): void {\n    this.activeCategorySubject.next(id);\n  }\n}\n"]}