{"version":3,"file":"breadcrum.component.js","sourceRoot":"","sources":["../../../../../../../../packages/modules/rc-ui/src/lib/shared/patterns/breadcrum.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { NgClass } from '@angular/common';\nimport {\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  inject,\n  Input,\n  OnDestroy,\n} from '@angular/core';\nimport {\n  ActivatedRoute,\n  NavigationEnd,\n  Router,\n  RouterModule,\n} from '@angular/router';\nimport { filter, Subject, takeUntil } from 'rxjs';\n\nimport { VCLIconModule } from '@vcl/ng-vcl';\n\nexport interface IBreadcrumb {\n  label: string;\n  url: string;\n}\n\n@Component({\n  selector: 'rc-breadcrumb',\n  standalone: true,\n  imports: [NgClass, RouterModule, VCLIconModule],\n  template: `\n    @if (breadcrumbs.length && !breadcrumbsToExclude.includes(lastLabel)) {\n    <nav class=\"breadcrumb-nav\">\n      <ol>\n        @if (showRoot) {\n        <li>\n          <a\n            [routerLink]=\"[rootUrl]\"\n            class=\"breadcrumb-nav-item-label\"\n          >\n            {{ rootLabel }}\n          </a>\n          <vcl-icon\n            class=\"breadcrumb-nav-divider\"\n            icon=\"vcl:arrow-right\"\n          />\n        </li>\n        }\n\n        <!-- Dynamic crumbs -->\n        @for (breadcrumb of breadcrumbs; track breadcrumb.url; let last = $last)\n        {\n        <li [ngClass]=\"{ selected: last }\">\n          @if (!last) {\n          <a\n            [routerLink]=\"breadcrumb.url\"\n            class=\"breadcrumb-nav-item-label\"\n          >\n            {{ breadcrumb.label }}\n          </a>\n          <vcl-icon\n            class=\"breadcrumb-nav-divider\"\n            icon=\"vcl:arrow-right\"\n          />\n          } @else {\n          <span class=\"breadcrumb-nav-item-label\">\n            {{ breadcrumb.label }}\n          </span>\n          }\n        </li>\n        }\n      </ol>\n    </nav>\n    }\n  `,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class RcBreadcrumbComponent implements AfterViewInit, OnDestroy {\n  /**\n   * Text for the root crumb (defaults to \"Home\").\n   * You can change this from the host app: <rc-breadcrumb rootLabel=\"Dashboard\" />\n   */\n  @Input() rootLabel = 'Home';\n\n  /**\n   * Router URL for the root crumb.\n   * Defaults to '/'.\n   */\n  @Input() rootUrl = '/';\n\n  /**\n   * Whether to display the root crumb at all.\n   */\n  @Input() showRoot = true;\n\n  /**\n   * Labels to exclude when the last crumb matches them (e.g. a generic \"Home\" page).\n   * You can override from outside instead of relying on ROUTER constants.\n   */\n  @Input() breadcrumbsToExclude: string[] = [];\n\n  /**\n   * All generated breadcrumbs.\n   */\n  breadcrumbs: IBreadcrumb[] = [];\n\n  /**\n   * Convenience getter: last breadcrumb label or empty.\n   */\n  get lastLabel(): string {\n    return this.breadcrumbs[this.breadcrumbs.length - 1]?.label ?? '';\n  }\n\n  private readonly destroy$ = new Subject<void>();\n\n  private readonly cdr = inject(ChangeDetectorRef);\n  private readonly activatedRoute = inject(ActivatedRoute);\n  private readonly router = inject(Router);\n\n  ngAfterViewInit(): void {\n    // Rebuild breadcrumbs on each navigation end\n    this.router.events\n      .pipe(\n        filter((e): e is NavigationEnd => e instanceof NavigationEnd),\n        takeUntil(this.destroy$)\n      )\n      .subscribe(() => {\n        this.updateBreadcrumbs();\n      });\n\n    // initial build (in case we already have an active route)\n    this.updateBreadcrumbs();\n  }\n\n  ngOnDestroy(): void {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  // ---- internal helpers ----\n\n  private updateBreadcrumbs(): void {\n    const newBreadcrumbs = this.createBreadcrumbs(\n      this.activatedRoute.root\n    ).reduce((acc, { label, url }) => {\n      if (label !== '' && !acc.some((breadcrumb) => breadcrumb.url === url)) {\n        acc.push({ label, url });\n      }\n      return acc;\n    }, [] as IBreadcrumb[]);\n\n    // shallow comparison is enough; array reference change triggers update\n    if (this.breadcrumbs !== newBreadcrumbs) {\n      this.breadcrumbs = newBreadcrumbs;\n      this.cdr.markForCheck();\n    }\n  }\n\n  private createBreadcrumbs(\n    route: ActivatedRoute,\n    url = '',\n    breadcrumbs: IBreadcrumb[] = []\n  ): IBreadcrumb[] {\n    const children: ActivatedRoute[] = route.children;\n\n    if (children.length === 0) {\n      return breadcrumbs;\n    }\n\n    for (const child of children) {\n      const routeURL: string = child.snapshot.url\n        .map((segment) => segment.path)\n        .join('/');\n\n      if (routeURL !== '') {\n        url += `/${routeURL}`;\n      }\n\n      const data = child.snapshot.data;\n      let label = '';\n\n      // Support both: data.breadcrumb: string | (data) => string\n      if (typeof data['breadcrumb'] === 'function') {\n        label = data['breadcrumb'](data);\n      } else {\n        label = data['breadcrumb'] ?? child.snapshot.title ?? '';\n      }\n\n      if (\n        label !== '' &&\n        label !== breadcrumbs[breadcrumbs.length - 1]?.label\n      ) {\n        breadcrumbs.push({ label, url });\n      }\n\n      // Continue recursively down the tree\n      return this.createBreadcrumbs(child, url, breadcrumbs);\n    }\n\n    return breadcrumbs;\n  }\n}\n"]}